<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>닉네임으로 caavatarimg 주소 추출</title>
</head>
<body>
  <h2>닉네임 입력 후 caavatarimg 주소 추출</h2>
  <input type="text" id="nickname" placeholder="닉네임 입력" />
  <button onclick="fetchAvatarURL()">주소 찾기</button>

  <div id="result" style="margin-top: 20px; font-weight: bold;"></div>

  <script>
    async function fetchAvatarURL() {
      const nickname = document.getElementById('nickname').value.trim();
      if (!nickname) {
        alert('닉네임을 입력하세요.');
        return;
      }

      const url = `https://ca.nexon.com/MyBlock/Information/${encodeURIComponent(nickname)}/0`;

      try {
        const response = await fetch(url, {mode: 'cors'});
        if (!response.ok) {
          throw new Error('페이지를 불러올 수 없습니다.');
        }
        const text = await response.text();
        // 정규식으로 personal 클래스 내 img src 찾기
        const match = text.match(/<div class="personal[\s\S]*?<img src="([^"]+\.gif)"/);
        if (match && match[1]) {
          document.getElementById('result').textContent = match[1];
        } else {
          document.getElementById('result').textContent = "caavatarimg 주소를 찾을 수 없습니다.";
        }
      } catch (error) {
        document.getElementById('result').textContent = "주소를 가져오는 중 오류가 발생했습니다: " + error.message;
      }
    }
  </script>
</body>
</html>
